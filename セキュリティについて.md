# セキュリティ設計における重要なチェック項目と解説

##  1. ゼロトラスト思想が採用されているか（内部通信も信用しない）

###  概要
ゼロトラスト（Zero Trust）とは、**社内ネットワークや内部システムであっても「安全」とは見なさず、常に検証する**という考え方。

###  具体的には
- 社内LANに接続されている端末でも、**通信の都度アクセス制御・認証**を実施。
- VPN内でも一つ一つの通信に対し**制御とログ記録**を行う。
- サーバー間通信やAPI通信も**TLSなどで暗号化**し、**認証付き**にする。

###  なぜ重要か
- 内部侵入された場合、**横展開のリスク**が非常に高い。
- 境界型防御だけでは**内部脅威に無力**なため。

---

##  2. MFAや端末認証が導入されているか

###  MFA（Multi-Factor Authentication）とは
パスワードに加え、**物理トークンやスマホアプリなどによる2段階認証**を加える方式。

###  具体例
- ID＋パスワード＋スマホ認証（TOTP）
- ICカード＋PINコード
- FIDOキー（例：YubiKey）

### 端末認証とは
- 接続元端末が**管理されたデバイスかどうかをチェック**する機構。
  - 例：クライアント証明書の確認、MDM管理の端末だけ許可。

###  なぜ重要か
- 認証情報が漏洩しても、**無関係な端末からはアクセスできない**。
- SaaSやリモートアクセス環境での**セキュリティ向上**に直結。

---

##  3. HTTP以外の通信（LDAP, Syslog, SNMPなど）も暗号化されているか

###  なぜ暗号化が必要か
- HTTP以外の通信には**重要な情報（認証情報、ログ、設定など）が含まれる**。
- 暗号化されていないと、**パケットキャプチャで情報漏えいのリスク**がある。

###  安全なプロトコルの例
| プロトコル | 安全な代替または暗号化設定 |
|------------|-----------------------------|
| LDAP       | **LDAPS (TCP/636)**         |
| Syslog     | **Syslog over TLS (TCP/6514)** |
| SNMP       | **SNMPv3（認証＋暗号化対応）** |

###  ポイント
- 内部ネットワークでも**平文通信は避ける**。
- 暗号化＋認証で、**盗聴・改ざん・なりすまし**に強い設計を行う。

---

##  4. 不必要な特権アクセスやアカウントが存在しないか（最小権限）

###  最小権限の原則
- 利用者やプロセスには**必要最小限の権限だけを与える**。

###  よくある問題例
- rootユーザーの共有利用
- 退職者のアカウントが放置されている
- バッチ処理用アカウントが全フォルダにフルアクセス

###  対策例
- **sudoを使って操作を限定**。
- **定期的なアカウント棚卸とログ確認**。
- 業務単位でアカウントを分け、**監査ログを明確化**。

### なぜ重要か
- 特権アカウントを乗っ取られた場合の影響が甚大。
- アクセス制限により、**被害範囲の最小化**と**原因特定の容易化**が可能。

---

## まとめ（表形式）

| チェック項目 | 意図 |
|--------------|------|
| ゼロトラスト | 内部脅威や侵害後の拡大防止 |
| MFA・端末認証 | なりすまし防止、リモートアクセス制御 |
| HTTP以外の暗号化 | パケット盗聴や中間者攻撃の防止 |
| 最小権限 | 被害最小化、誤操作防止、監査性向上 |

